<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>Even More Modifiers: Modifier</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="icon.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Even More Modifiers
   &#160;<span id="projectnumber">0.1</span>
   </div>
   <div id="projectbrief">A framework for Terraria mods</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Packages</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('md__home_travis_build_Jofairden_EvenMoreModifiers_docs_modifier.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Modifier </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><hr/>
<p> To make a new Modifier, simply make a new class that inherits the class <code>Modifier</code> in the <code>Loot.System</code> namespace.</p>
<h4>Properties</h4>
<hr/>
<h5>Brief properties explanation</h5>
<p>Modifiers have the following features:</p>
<p><b>Power rolls</b>: modifiers can roll its power by 'magnitudes'. This happens when the modifier is rolled on the item, and these values are saved.</p>
<p><b>Weighted roll chances</b>: modifiers can have different chances of being rolling (weighted rolling). The default weight is 1f. If you increase this number, your modifier will show up more often. Putting it to 2f will make it show up twice as often. Something like 10f is a really high roll chance. For very powerful modifiers, you want the roll chance to be low.</p>
<p><b>Rarity levels</b>: the total rarity is decided by the sum of the rarity level of all modifiers on the item. The default is 1f. If you have more powerful modifiers, you will want to increase this number to signify the power of it.</p>
<p><b>Modifiers function like GlobalItems</b>. This means you have access to pretty much all hooks available in <a class="el" href="class_global_item.html">GlobalItem</a> (a few <a href="https://github.com/Jofairden/EvenMoreModifiers/blob/rework/System/Modifier.cs#L297">exceptions</a>). You can assume the item in the context of a hook (the item parameter) is an item being influenced by that modifier. This is handled by EMM and out of your way, mostly consisting of <a href="https://github.com/Jofairden/EvenMoreModifiers/blob/rework/ModifierItem.cs">boilerplate code</a>.</p>
<p>Below I will detail all the properties of <a href="https://github.com/Jofairden/EvenMoreModifiers/blob/rework/System/Modifier.cs#L22-L112">ModifierProperties</a></p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;public float MinMagnitude { get; private set; }</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;public float MaxMagnitude { get; private set; }</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;public float MagnitudeStrength { get; private set; }</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;public float BasePower { get; private set; }</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;public float RarityLevel { get; private set; }</div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;public float RollChance { get; private set; }</div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;public int RoundPrecision { get; private set; }</div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;public float Magnitude { get; private set; }</div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;private float _power;</div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;public float Power</div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;{</div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;    get { return _power; }</div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;    private set</div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;    {</div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;        _power = value;</div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;        RoundedPower = (float)Math.Round(value, RoundPrecision);</div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;    }</div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;}</div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;public float RoundedPower</div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;{</div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;    get;</div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;    private set;</div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;}</div></div><!-- fragment --><h5>Properties explanation in context</h5>
<p><b>MinMagnitude</b> and <b>MaxMagnitude</b> define the range that <b>Magnitude</b> will roll in. For example 10f - 15f will make <b>Magnitude</b> roll between 10f and 15f. <b>MagnitudeStrength</b> influences the final result of that roll as a multiplier. For example setting this to 2 and rolling the upper bound of the previous example (15f) would result in a Magnitude of 30. <b>Power</b> is then calculated by <b>BasePower</b>***Magnitude**, so a BasePower of 10 in the previous context would result in a Power of 300. When Power is set, it automatically sets <b>RoundedPower</b> as well. This property is primarily useful for tooltips, where you'll likely want to display 230% instead of something like 230.568893%. The precision of the rounding can be adjusted with <b>RoundPrecision</b>, which defaults to 0. So by default it will prune all decimals. If you set it to 1, it will leave 1 decimal, at 2 it will leave 2, and so forth...</p>
<p>These Properties (and all other hooks) support inheritance. A good example of that can be found <a href="https://github.com/Jofairden/EvenMoreModifiers/blob/rework/Modifiers/EquipModifiers/KnockbackImmunity.cs#L20-L31">here</a> and <a href="https://github.com/Jofairden/EvenMoreModifiers/blob/rework/Modifiers/WeaponDebuffModifier.cs#L57-L60">here</a>.</p>
<h5>Modifying properties</h5>
<p>To modify the Properties, you override the <a href="https://github.com/Jofairden/EvenMoreModifiers/blob/rework/System/Modifier.cs#L134-L137">GetModifierProperties</a> method and return a new object. All properties have a default value, to set specific ones you can specify the parameter names like so: </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;public virtual ModifierProperties GetModifierProperties(Item item)</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;{</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;    return new ModifierProperties(roundPrecision: 1, minMagnitude: 15f, maxMagnitude: 30f);</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;}</div></div><!-- fragment --><p>Please note that you need to be careful when using inheritance! Always call base first and then modify whatever properties it returns:</p>
<p>A base class: </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;public abstract class EquipModifier : Modifier</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;{</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;    public override ModifierProperties GetModifierProperties(Item item)</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;    {</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;        return new ModifierProperties(magnitudeStrength: item.IsAccessory() ? .6f : 1f);</div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;    }</div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;}</div></div><!-- fragment --><p>If a class inherits from this base class, the properties should be handled like so: </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;public override ModifierProperties GetModifierProperties(Item item)</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;{</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;    return base.GetModifierProperties(item).Set(maxMagnitude: 15f);</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;}</div></div><!-- fragment --><h4>Saving and loading data per modifier</h4>
<hr/>
<p> You can save and load your own data per modifier, an example can be seen <a href="https://github.com/Jofairden/EvenMoreModifiers/blob/rework/Modifiers/WeaponModifiers/RandomDebuff.cs#L43-L53">here</a>. Essentially, saving and loading works exactly the same as you are used to. The handling of it is managed by EMM itself and out of your way.</p>
<h5>Saving data</h5>
<p>Please note that, inside the Save method the TagCompound already contains necessary save data for the modifier (which is automatically handled by EMM). Make sure that you don't clear the TC or make a new instance! </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;public override void Save(Item item, TagCompound tag)</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;{</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;    // If you use inheritance, always call base first</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;    base.Save(item, tag);</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;</div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;    // Any saving here!</div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;}</div></div><!-- fragment --><p>##### Loading data </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;public override void Load(Item item, TagCompound tag)</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;{</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;    // If you use inheritance, always call base first</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;    base.Load(item, tag);</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;</div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;    // Any loading here!</div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;}</div></div><!-- fragment --><h4>Tooltips</h4>
<hr/>
<p> Tooltips by modifiers are automatically managed by EMM, and it does the following:</p><ul>
<li>Item name automatically modified if rarity overrides color and/or adds prefix/suffix</li>
<li>Adds a rarity tag by name [Modifier:Name]</li>
<li>Adds a modifier line (description) per line by name [Modifier:Description:i]</li>
</ul>
<p>However, you can still modify the tooltips per modifier if you want to. The ModifyTooltips method is called after this automatic behaviour. </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.11 </li>
  </ul>
</div>
</body>
</html>
